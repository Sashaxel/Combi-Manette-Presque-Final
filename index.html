<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Manette + Combos + Nouvel onglet</title>
<style>
  body, html {
    height: 100%; margin: 0; display: flex; justify-content: center; align-items: center; flex-direction: column;
    font-family: Arial, sans-serif;
  }
  #message {
    font-size: 2rem;
    margin-bottom: 20px;
    text-align: center;
  }
  #arrow {
    font-size: 8rem;
    user-select: none;
  }
</style>
</head>
<body>
  <div id="message">Connecte une manette</div>
  <div id="arrow"></div>

<script>
(() => {
  const messageDiv = document.getElementById("message");
  const arrowDiv = document.getElementById("arrow");

  // Combinaisons d√©finies
  const COMBO_1 = ["down", "down", "up", "up", "right", "left", "right", "left"];  // message simple
  const COMBO_2 = ["right", "right", "right", "right", "up", "left", "right"];     // vid√©o 1
  const COMBO_3 = ["left", "left", "left", "left", "down", "right", "left"];       // vid√©o 2

  // Liens Youtube (modifie ici tes URLs)
  const YOUTUBE_LINK_1 = "https://www.youtube.com/watch?v=dQw4w9WgXcQ";
  const YOUTUBE_LINK_2 = "https://www.youtube.com/watch?v=oHg5SJYRHA0";

  let directions = [];
  let lastDirection = null;
  const THRESHOLD = 0.5;

  const arrows = {
    up: "‚Üë",
    down: "‚Üì",
    left: "‚Üê",
    right: "‚Üí",
    none: ""
  };

  function getDirectionFromAxes(x, y) {
    if (y > THRESHOLD) return "down";
    if (y < -THRESHOLD) return "up";
    if (x > THRESHOLD) return "right";
    if (x < -THRESHOLD) return "left";
    return null;
  }

  function endsWithCombo(arr, combo) {
    if (arr.length < combo.length) return false;
    return arr.slice(-combo.length).join(",") === combo.join(",");
  }

  function checkCombos() {
    if (endsWithCombo(directions, COMBO_1)) {
      messageDiv.textContent = "Bonne combinaison ! üéâ";
      directions = [];
      return true;
    }
    if (endsWithCombo(directions, COMBO_2)) {
      messageDiv.textContent = "Ouverture vid√©o 1 !";
      window.open(YOUTUBE_LINK_1, "_blank");
      directions = [];
      return true;
    }
    if (endsWithCombo(directions, COMBO_3)) {
      messageDiv.textContent = "Ouverture vid√©o 2 !";
      window.open(YOUTUBE_LINK_2, "_blank");
      directions = [];
      return true;
    }
    return false;
  }

  function update() {
    const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
    if (!gamepads) {
      messageDiv.textContent = "Connecte une manette";
      arrowDiv.textContent = "";
      requestAnimationFrame(update);
      return;
    }

    const gp = gamepads[0];

    if (!gp) {
      messageDiv.textContent = "Connecte une manette";
      arrowDiv.textContent = "";
      requestAnimationFrame(update);
      return;
    }

    const x = gp.axes[0];
    const y = gp.axes[1];
    const dir = getDirectionFromAxes(x, y);

    if (dir && dir !== lastDirection) {
      directions.push(dir);
      if (directions.length > 30) directions.shift();

      if (!checkCombos()) {
        messageDiv.textContent = `Direction d√©tect√©e : ${dir}`;
      }

      arrowDiv.textContent = arrows[dir];
      lastDirection = dir;
    } else if (!dir) {
      arrowDiv.textContent = "";
      lastDirection = null;
    }

    requestAnimationFrame(update);
  }

  window.addEventListener("gamepadconnected", () => {
    messageDiv.textContent = "Manette connect√©e ! Utilise le joystick gauche";
    requestAnimationFrame(update);
  });

  window.addEventListener("gamepaddisconnected", () => {
    messageDiv.textContent = "Manette d√©connect√©e";
    arrowDiv.textContent = "";
  });

  if (navigator.getGamepads && navigator.getGamepads()[0]) {
    messageDiv.textContent = "Manette connect√©e ! Utilise le joystick gauche";
    requestAnimationFrame(update);
  }
})();
</script>

</body>
</html>
