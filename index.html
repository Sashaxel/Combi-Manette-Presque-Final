<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>DÃ©tection Manette</title>
  <style>
    body {
      background-color: #111;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: sans-serif;
      font-size: 2rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="message">Connecte une manette</div>

  <script>
    let messageDiv = document.getElementById("message");
    let directions = [];
    let gamepadIndex = null;

    const COMBO_1 = ["down", "down", "up", "up", "right", "left", "right", "left"];
    const COMBO_2 = ["right", "right", "right", "right", "up", "left", "right"];
    const COMBO_3 = ["left", "left", "left", "left", "down", "right", "left"];

    const YOUTUBE_LINK_1 = "https://www.youtube.com/watch?v=LIEN1"; // remplace ici
    const YOUTUBE_LINK_2 = "https://www.youtube.com/watch?v=LIEN2"; // remplace ici

    window.addEventListener("gamepadconnected", (e) => {
      gamepadIndex = e.gamepad.index;
      messageDiv.textContent = "Manette connectÃ©e. Essaie une combinaison...";
      pollGamepad();
    });

    function pollGamepad() {
      const gp = navigator.getGamepads()[gamepadIndex];
      if (!gp) return;

      const threshold = 0.5;
      let x = gp.axes[0];
      let y = gp.axes[1];
      let dir = null;

      if (y > threshold) dir = "down";
      else if (y < -threshold) dir = "up";
      else if (x > threshold) dir = "right";
      else if (x < -threshold) dir = "left";

      if (dir && (directions.length === 0 || directions[directions.length - 1] !== dir)) {
        directions.push(dir);
        if (directions.length > 10) directions.shift();

        checkCombos();
      }

      requestAnimationFrame(pollGamepad);
    }

    function checkCombos() {
      const dirStr = directions.join(",");

      if (dirStr.endsWith(COMBO_1.join(","))) {
        messageDiv.textContent = "Bonne combinaison ! ðŸŽ‰";
      }
      else if (dirStr.endsWith(COMBO_2.join(","))) {
        window.open(YOUTUBE_LINK_1, "_blank");
        directions = [];
      }
      else if (dirStr.endsWith(COMBO_3.join(","))) {
        window.open(YOUTUBE_LINK_2, "_blank");
        directions = [];
      }
    }
  </script>
</body>
</html>
